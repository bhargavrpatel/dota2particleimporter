<!DOCTYPE html>
<html>
  <head>
    <title>Dota 2 Addons | Decompiled Particle importer</title>
    <link rel="stylesheet" type="text/css" href="assets\css\style.css">
    <!-- <link rel="stylesheet" type="text/css" href="assets\css\jquery-ui.theme.min.css"> -->
    <script src="assets\js\jquery.min.js"></script>
    <script src="assets\js\jquery-ui.min.js"></script>
    <script src="assets\js\setup.js"></script>
	<script>
	  $(function() {
	    $( "#accordion" ).accordion({
	      heightStyle: "content"
	    });
	  });
	</script>
  </head>
  <body>
	<div id="container">
	  	<div id="header">
	  		<div id="banner">
	  			<img width="564" src="assets\images\banner.png">
	  		</div>
	  		<div id="title">
	  			Decompiled Particle Importer <span>v1.0.0</span>
	  		</div>
	  	</div>

	  	<div id="content">
			<div id="contentHeader">Particle Import Path(s)</div>
			<div id="particleContent">
				<div class="notice">Ensure you have setup paths of Decompiled Particles' folder and your addon's content folder first</div>
				
			</div>
	  	</div>

  	<div id="footer">
	  		<input id="ugcDialogue" style = "display: none;" type= "file" />
	  		<div id="ugcButton" class="clickable wide dark">Select target addon's addoninfo.txt</div>
	  		<div id="preCacheButton" class="clickable wide dark">Configure Precache output</div>
	  		<div id="importButton" class="clickable wide">Import to Addon</div>
	  	</div>
	</div>

	<script type="text/javascript">
		var fs = require('fs');
		function chooseFile(name) {
			var chooser = $(name);
			chooser.change(function(evt) {
			console.log($(this).val());

			var dirPath = $(this).val().replace(/\\/g, '/');
			
			var ugc_path = dirPath.substring(0, dirPath.indexOf("dota_ugc/") + "dota_ugc/".length);

			if(!fs.existsSync(ugc_path) || !(fs.existsSync(ugc_path+"/content/dota_addons/"+addon_name))) {
				alert("Invalid folder, is this inside dota_ugc? All target addons are to be inside dota_ugc folder. Redo please!");
			} else {
				var addon_name = dirPath.substring(dirPath.indexOf("dota_addons/") + "dota_addons/".length, dirPath.indexOf("/addoninfo.txt"))
				localStorage["ugc_path"] = ugc_path
				localStorage["addon_name"] = addon_name
				localStorage["content_path"] = ugc_path+"/content/dota_addons/"+addon_name
			}
			
		});

			chooser.trigger('click');  
		}

		$("#ugcButton").click(function() {
			chooseFile('#ugcDialogue');
		});

	</script>
  </body>
</html>

